import type { Exploit, ExploitStats } from "@/types/exploit"

export const exploitStats: ExploitStats = {
  totalExploits: 347,
  totalValueLost: "$3.2B",
  protocolsAffected: 156,
  averageLoss: "$9.2M",
  quarterlyChange: 23,
  yearlyChange: -15,
}

export const exploits: Exploit[] = [
  {
    id: "wormhole-bridge-2022",
    title: "Wormhole Bridge Exploit",
    description: "Signature verification bypass in Wormhole bridge allowing attacker to mint 120,000 ETH on Solana",
    valueLost: "$320M",
    category: "Bridge",
    year: 2022,
    date: "February 2, 2022",
    attackType: "Signature Verification Bypass",
    rootCause: "Outdated Guardian Set Validation",
    networks: "Ethereum â†” Solana",
    recovery: "Jump Crypto bailout",
    status: "resolved",
    severity: "critical",
    details: {
      timeline: "Single transaction exploit",
      impact: "120,000 ETH minted illegitimately",
    },
  },
  {
    id: "terra-luna-2022",
    title: "Terra Luna Collapse",
    description: "Algorithmic stablecoin death spiral triggered by large UST redemptions and arbitrage attacks",
    valueLost: "$60B",
    category: "Algorithmic Stablecoin",
    year: 2022,
    date: "May 9-12, 2022",
    attackType: "Economic Attack / Death Spiral",
    rootCause: "Flawed Algorithmic Design",
    trigger: "Large UST Redemptions",
    status: "total-loss",
    severity: "critical",
    details: {
      impact: "Entire ecosystem collapse",
      timeline: "4-day collapse period",
    },
  },
  {
    id: "ronin-bridge-2022",
    title: "Ronin Bridge Exploit",
    description:
      "Private key compromise of validator nodes allowing unauthorized withdrawals from Axie Infinity's Ronin bridge",
    valueLost: "$625M",
    category: "Bridge",
    year: 2022,
    date: "March 23, 2022",
    attackType: "Private Key Compromise",
    rootCause: "Social Engineering + Centralization",
    discoveryDelay: "6 days later",
    recovery: "Partial (~$30M)",
    status: "partial",
    severity: "critical",
    details: {
      validators: "5 of 9 compromised",
      timeline: "Undetected for 6 days",
    },
  },
  {
    id: "ftx-collapse-2022",
    title: "FTX Exchange Collapse",
    description:
      "Misappropriation of customer funds and liquidity crisis leading to bankruptcy of major crypto exchange",
    valueLost: "$8B",
    category: "CeFi",
    year: 2022,
    date: "November 2022",
    attackType: "Internal Fraud / Misappropriation",
    rootCause: "Lack of Segregation & Oversight",
    trigger: "Alameda Research Exposure",
    legalStatus: "Criminal charges filed",
    recovery: "Ongoing bankruptcy",
    status: "ongoing",
    severity: "critical",
    details: {
      impact: "Customer funds misappropriated",
      timeline: "Gradual collapse over weeks",
    },
  },
  {
    id: "poly-network-2021",
    title: "Poly Network Exploit",
    description: "Cross-chain protocol exploit allowing attacker to drain funds across multiple blockchains",
    valueLost: "$611M",
    category: "Bridge",
    year: 2021,
    date: "August 10, 2021",
    attackType: "Cross-Chain Validation Bypass",
    rootCause: "Flawed Cross-Chain Logic",
    networks: "Ethereum, BSC, Polygon",
    recovery: "Full recovery (white hat)",
    status: "resolved",
    severity: "critical",
    details: {
      timeline: "Funds returned by attacker",
      impact: "Largest DeFi hack at the time",
    },
  },
]

// Helper functions
export const getExploitStats = (): ExploitStats => exploitStats

export const getAllExploits = (): Exploit[] => exploits

export const getExploitsByCategory = (category: string): Exploit[] =>
  exploits.filter((exploit) => exploit.category === category)

export const getExploitsBySeverity = (severity: string): Exploit[] =>
  exploits.filter((exploit) => exploit.severity === severity)

export const getCriticalExploits = (): Exploit[] => exploits.filter((exploit) => exploit.severity === "critical")

export const getExploitById = (id: string): Exploit | undefined => exploits.find((exploit) => exploit.id === id)
